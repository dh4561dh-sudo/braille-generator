<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Braille Transcriber Global</title>

<style>
body{
  font-family:Segoe UI,system-ui;
  background:#f1f5f9;
  padding:40px;
}
.container{
  max-width:700px;
  margin:auto;
  background:#fff;
  border:2px solid #0f172a;
  border-radius:12px;
  overflow:hidden;
}
.header{
  background:#0f172a;
  color:#fff;
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
}
.body{
  padding:25px;
}
select,input,button{
  width:100%;
  padding:12px;
  margin-bottom:15px;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  background:#c5a059;
  font-weight:bold;
  cursor:pointer;
}
.notice{
  background:#f8fafc;
  padding:12px;
  border-radius:6px;
  font-size:13px;
  margin-bottom:15px;
}
</style>
</head>

<body>

<div class="container">
<div class="header">
  <div>⠃⠗⠇ BRAILLE TRANSCRIBER GLOBAL</div>
  <div>v2.0</div>
</div>

<div class="body">

<div class="notice" id="noticeBox"></div>

<label id="labelUrl"></label>
<input type="text" id="urlInput">

<label id="labelLang"></label>
<select id="lang">
<option value="pt">Português</option>
<option value="en">English</option>
<option value="es">Español</option>
<option value="fr">Français</option>
<option value="de">Deutsch</option>
<option value="it">Italiano</option>
</select>

<button id="generateBtn" onclick="generate()"></button>

</div>
</div>

<script>
/* =========================
   TRADUÇÕES PROFISSIONAIS
========================= */

const translations = {
pt:{
notice:`<strong>Aviso Importante:</strong><br>
Este gerador produz Braille textual normativo (tabelas oficiais).
Destina-se à impressão em embossers compatíveis.
Não contempla notação matemática ou científica avançada.`,
labelUrl:"URL da postagem:",
placeholder:"Cole aqui a URL do seu post do Blogger",
labelLang:"Idioma do conteúdo:",
button:"Gerar arquivo Braille",
alertUrl:"Por favor, informe a URL da postagem.",
alertError:"Não foi possível acessar o conteúdo da postagem.",
filename:"documento_braille.brf"
},
en:{
notice:`<strong>Important Notice:</strong><br>
This generator produces normative Braille using official tables.
Intended for printing on compatible Braille embossers.
Does not support advanced mathematical or scientific notation.`,
labelUrl:"Post URL:",
placeholder:"Paste the URL of your Blogger post here",
labelLang:"Content language:",
button:"Generate Braille file",
alertUrl:"Please enter the post URL.",
alertError:"Unable to access the post content.",
filename:"braille_document.brf"
},
es:{
notice:`<strong>Aviso Importante:</strong><br>
Este generador produce Braille normativo usando tablas oficiales.
Está destinado a la impresión en embossers compatibles.
No admite notación matemática o científica avanzada.`,
labelUrl:"URL de la publicación:",
placeholder:"Pegue aquí la URL de su entrada de Blogger",
labelLang:"Idioma del contenido:",
button:"Generar archivo Braille",
alertUrl:"Por favor, introduzca la URL de la publicación.",
alertError:"No se pudo acceder al contenido de la publicación.",
filename:"documento_braille.brf"
},
fr:{
notice:`<strong>Avis Important :</strong><br>
Ce générateur produit du Braille normatif à l’aide de tables officielles.
Destiné à l’impression sur des embossers compatibles.
Ne prend pas en charge la notation mathématique ou scientifique avancée.`,
labelUrl:"URL de l’article :",
placeholder:"Collez ici l’URL de votre article Blogger",
labelLang:"Langue du contenu :",
button:"Générer le fichier Braille",
alertUrl:"Veuillez saisir l’URL de l’article.",
alertError:"Impossible d’accéder au contenu de l’article.",
filename:"document_braille.brf"
},
de:{
notice:`<strong>Wichtiger Hinweis:</strong><br>
Dieser Generator erzeugt normatives Braille mit offiziellen Tabellen.
Vorgesehen für den Druck auf kompatiblen Braille-Embossern.
Unterstützt keine erweiterte mathematische oder wissenschaftliche Notation.`,
labelUrl:"Beitrags-URL:",
placeholder:"Fügen Sie hier die URL Ihres Blogger-Beitrags ein",
labelLang:"Inhaltssprache:",
button:"Braille-Datei erstellen",
alertUrl:"Bitte geben Sie die Beitrags-URL ein.",
alertError:"Der Inhalt des Beitrags konnte nicht abgerufen werden.",
filename:"braille_dokument.brf"
},
it:{
notice:`<strong>Avviso Importante:</strong><br>
Questo generatore produce Braille normativo con tabelle ufficiali.
Destinato alla stampa su embossers compatibili.
Non supporta notazione matematica o scientifica avanzata.`,
labelUrl:"URL del post:",
placeholder:"Incolla qui l’URL del tuo post Blogger",
labelLang:"Lingua del contenuto:",
button:"Genera file Braille",
alertUrl:"Inserisci l’URL del post.",
alertError:"Impossibile accedere al contenuto del post.",
filename:"documento_braille.brf"
}
};

/* =========================
   TROCA DE IDIOMA
========================= */

function updateLanguage(){
  const lang=document.getElementById("lang").value;
  const t=translations[lang];
  document.getElementById("noticeBox").innerHTML=t.notice;
  document.getElementById("labelUrl").innerText=t.labelUrl;
  document.getElementById("urlInput").placeholder=t.placeholder;
  document.getElementById("labelLang").innerText=t.labelLang;
  document.getElementById("generateBtn").innerText=t.button;
}

document.getElementById("lang").addEventListener("change",updateLanguage);
updateLanguage();

/* =========================
   GERAÇÃO BRAILLE NORMATIVA
========================= */

async function generate(){
  const lang=document.getElementById("lang").value;
  const t=translations[lang];
  const url=document.getElementById("urlInput").value.trim();

  if(!url){
    alert(t.alertUrl);
    return;
  }

  try{
    const proxy="https://api.allorigins.win/raw?url=";
    const response=await fetch(proxy+encodeURIComponent(url));
    const html=await response.text();

    const parser=new DOMParser();
    const doc=parser.parseFromString(html,"text/html");

    const content=doc.querySelector("article")?.innerText ||
                  doc.querySelector(".post-body")?.innerText ||
                  doc.body.innerText;

    if(!window.liblouis){
      alert("Motor Braille não carregado.");
      return;
    }

    const tables={
      pt:"pt-br.dis",
      en:"en-ueb-g2.ctb",
      es:"es.ctb",
      fr:"fr-g2.ctb",
      de:"de-g2.ctb",
      it:"it.ctb"
    };

    const table=tables[lang]||"en-ueb-g2.ctb";
    const braille=await window.liblouis.translateString(table, content);

    const blob=new Blob([braille],{type:"text/plain;charset=utf-8"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download=t.filename;
    a.click();

  }catch(e){
    console.error(e);
    alert(t.alertError);
  }
}
</script>

<script src="https://unpkg.com/liblouis@0.3.1/dist/liblouis.min.js"></script>

</body>
</html>
